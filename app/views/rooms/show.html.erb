

<div class="flex flex-row">
  <div class="flex flex-col w-1/3 mt-24">
    <%= render @room %>
  </div>

  <section class="bg-white flex flex-col h-screen px-6 flex-grow border-l-2 border-theme-grey-300">
    <section class="flex flex-col flex-grow">
      <% if @room.messages.any? %>
        <section class="flex-grow overflow-auto my-3">
          <% previous_user_name = nil %>
          <% @room.messages.order(created_at: :asc).each do |message| %>
            <% if message.user.name != previous_user_name %>
              <p class="text-xs <%= message.user.name == 'cauli' ? 'text-right text-theme-turquoise justify-end' : 'text-theme-grey-400 justify-end w-full' %>  mx-2 mb-0.5"><%= message.user.name %></p>
            <% end %>
            <div class="<%= message.user.name == 'cauli' ? 'text-right justify-end items-end' : 'text-left justify-start' %> flex flex-col text-xs">
              <div class="<%= message.user.name == 'cauli' ? 'bg-theme-greeny' : 'bg-theme-grey-200' %> my-0.5 rounded-full w-auto px-3 py-2" >
                <span><%= message.content %></span>
              </div>
            </div>
            <% previous_user_name = message.user.name %>
          <% end %>
        </section>
      <% else %>
        <section class="flex-grow overflow-auto">No messages. When someone sends one, it will appear here</section>
      <% end %>
    <section>


    <%= form_with model: [ @room, Message.new ], local: true do |form| %>
      <div class="flex flex-row bottom-0 w-full">
        <div class="mb-4 w-full">
          <%= form.text_field :content, autofocus: true, class: "appearance-none border-0 rounded-full border-2 border-theme-grey-300 w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:border-theme-greeny focus:border-3", placeholder: "Write a message..." %>
        </div>
      </div>
    <% end %>
  </section>


</div> 
<script>
  function toggleOptions() {
    var options = document.getElementById("options");
    if (options.style.display === "none") {
      options.style.display = "block";
    } else {
      options.style.display = "none";
    }
  }
</script>
